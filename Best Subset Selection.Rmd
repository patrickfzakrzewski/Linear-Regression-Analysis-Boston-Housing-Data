Model Selection
================

This is a R Markdown document. Markdown is a simple formatting syntax for authoring web pages,
and a very nice way of distributing an analysis. It has some very simple syntax rules.


```{r}
library(ISLR)
summary(Hitters)
```
There are some missing values here, so before we proceed we will remove them:

```{r}
Hitters=na.omit(Hitters)
with(Hitters,sum(is.na(Salary)))




Best Subset regression
------------------------
WE will now use the package 'leaps' to evaluate all the best-subset models. #best subset model looks for best model (lowest RSS) at each size
```{r}
library(leaps)
regfit.full=regsubsets(Salary~.,data=Hitters) #finds best subset of each size
summary(regfit.full) 
```
It gives by default best-subsets up to size 8;lets increase that to 19,
i.e. all the variables
```{r}
regfit.full=regsubsets(Salary~.,data=Hitters,nvmax=19)
reg.summary=summary(regfit.full)
names(reg.summary)
plot(reg.summary$cp,xlab="Number of Variables",ylab="Cp")
which.min(reg.summary$cp)
points(10,reg.summary$cp[10],pch=20,col="red") #colors 10th point red on plot

There is a plot method for the 'regsubsets' object
```{r}
plot(regfit.full,scale="Cp")
coef(regfit.full,10)
```
